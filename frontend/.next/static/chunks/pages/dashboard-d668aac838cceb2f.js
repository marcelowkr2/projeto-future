(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[724],{3172:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var a,s=r(7876),n=r(4232),l=r(1040),o=r(1047);let c="label";function u(e,t){"function"==typeof e?e(t):e&&(e.current=t)}function i(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c,a=[];e.datasets=t.map(t=>{let s=e.datasets.find(e=>e[r]===t[r]);return!s||!t.data||a.includes(s)?{...t}:(a.push(s),Object.assign(s,t),s)})}let d=(0,n.forwardRef)(function(e,t){let{height:r=150,width:a=300,redraw:s=!1,datasetIdKey:l,type:d,data:f,options:b,plugins:h=[],fallbackContent:p,updateMode:g,...E}=e,w=(0,n.useRef)(null),m=(0,n.useRef)(null),x=()=>{w.current&&(m.current=new o.t1(w.current,{type:d,data:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c,r={labels:[],datasets:[]};return r.labels=e.labels,i(r,e.datasets,t),r}(f,l),options:b&&{...b},plugins:h}),u(t,m.current))},_=()=>{u(t,null),m.current&&(m.current.destroy(),m.current=null)};return(0,n.useEffect)(()=>{!s&&m.current&&b&&function(e,t){let r=e.options;r&&t&&Object.assign(r,t)}(m.current,b)},[s,b]),(0,n.useEffect)(()=>{if(!s&&m.current)m.current.config.data.labels=f.labels},[s,f.labels]),(0,n.useEffect)(()=>{!s&&m.current&&f.datasets&&i(m.current.config.data,f.datasets,l)},[s,f.datasets]),(0,n.useEffect)(()=>{m.current&&(s?(_(),setTimeout(x)):m.current.update(g))},[s,b,f.labels,f.datasets,g]),(0,n.useEffect)(()=>{m.current&&(_(),setTimeout(x))},[d]),(0,n.useEffect)(()=>(x(),()=>_()),[]),n.createElement("canvas",{ref:w,role:"img",height:r,width:a,...E},p)}),f=(a=o.A6,o.t1.register(a),(0,n.forwardRef)((e,t)=>n.createElement(d,{...e,ref:t,type:"bar"})));o.t1.register(o.PP,o.kc,o.E8,o.hE,o.m_,o.s$);let b=()=>{let[e,t]=(0,n.useState)([]),[r,a]=(0,n.useState)("");(0,n.useEffect)(()=>{(async()=>{try{let e=await l.A.get("/api/control-assessments/");t(e.data)}catch(e){console.error("Erro ao buscar avalia\xe7\xf5es:",e)}})()},[]);let o=e.filter(e=>e.question.text.toLowerCase().includes(r.toLowerCase())),c={labels:o.map(e=>e.question.text),datasets:[{label:"Pontua\xe7\xe3o",data:o.map(e=>e.score),backgroundColor:"rgba(75, 192, 192, 0.2)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}]},u=async e=>{try{let t=await l.A.get("/api/control-assessments/".concat(e,"/generate-report/"),{responseType:"blob"}),r=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=r,a.setAttribute("download","report_".concat(e,".pdf")),document.body.appendChild(a),a.click()}catch(e){console.error("Erro ao baixar relat\xf3rio:",e)}};return(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{children:"Dashboard de Avalia\xe7\xf5es"}),(0,s.jsx)("input",{type:"text",placeholder:"Filtrar por pergunta",value:r,onChange:e=>a(e.target.value)}),(0,s.jsx)(f,{data:c}),(0,s.jsx)("div",{children:o.map(e=>(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:e.question.text}),(0,s.jsxs)("p",{children:["Pontua\xe7\xe3o: ",e.score]}),(0,s.jsx)("button",{onClick:()=>u(e.id),children:"Baixar Relat\xf3rio"})]},e.id))})]})}},5372:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return r(3172)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[697,238,636,593,792],()=>t(5372)),_N_E=e.O()}]);